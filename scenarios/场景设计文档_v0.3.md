# AI Project Management Platform - 场景设计文档 v0.3

## 开源分布式版本

> **设计原则**：开放、透明、去中心化、社区驱动

---

## 场景一：社区驱动的项目启动

### 场景描述
一个开源社区想要启动一个新的 AI 协作工具项目，通过本平台进行去中心化的项目管理和社区治理。

### 完整流程

```
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 1：项目创建与协议注册                                               │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 创始人通过 CLI 创建项目：                                                 │
│                                                                            │
│ $ aipm project create                                                   │
│                                                                            │
│ 项目配置：                                                               │
│ - 项目名称：OpenAI-Collab                                               │
│ - 描述：开源 AI 协作工具                                                │
│ - 治理模型：混合（民主+技术）                                           │
│ - 初始贡献者：5 人                                                     │
│                                                                            │
│ 生成 DID：did:aipm:openai-collab:abc123                                │
│                                                                            │
│ 协议注册：                                                              │
│ - 项目 manifest 存入 IPFS                                               │
│ - DID 文档上链                                                          │
│ - 创世交易记录                                                          │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 2：社区贡献者加入                                                  │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 新贡献者通过 DID 加入：                                                 │
│                                                                            │
│ $ aipm identity verify --did did:eth:alice:xyz                          │
│                                                                            │
│ 贡献者注册：                                                            │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 贡献者：Alice                                                        │ │
│ │ DID：did:eth:alice:xyz                                               │ │
│ │ 声誉分：85                                                          │ │
│ │ 专长：前端开发                                                       │ │
│ │ 认证：GitHub、邮箱                                                   │ │
│ │ 角色：开发者                                                         │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ 贡献者加入项目：                                                        │
│ - 验证 DID 身份                                                        │
│ │ 链接声誉协议                                                         │
│ │ 设置贡献权限                                                         │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 3：社区治理提案                                                    │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 发起技术路线图提案：                                                    │
│                                                                            │
│ 提案内容：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 标题：采用微前端架构                                                  │ │
│ │ 作者：Alice                                                          │ │
│ │ 内容：建议使用 Module Federation                                      │ │
│ │ 投票期：7 天                                                        │ │
│ │ 所需票数：>10% 参与率                                               │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ 社区讨论：                                                              │
│ - 论坛发帖                                                             │
│ - 视频会议                                                             │
│ - 异步投票                                                             │
│                                                                            │
│ 投票结果：                                                              │
│ - 参与：35%（超过阈值）                                                │
│ - 赞成：78%                                                            │
│ - 结果：通过 ✅                                                        │
│                                                                            │
│ 自动执行：                                                              │
│ - 更新项目 manifest                                                    │
│ │ 同步到 IPFS                                                         │
│ │ 链上记录决策                                                         │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## 场景二：分布式任务执行

### 场景描述
项目有多个任务需要执行，不同的 AI 节点通过 P2P 网络分布式执行任务。

### 任务执行流程

```
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 1：任务发布到 P2P 网络                                              │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 创建新任务：                                                            │
│                                                                            │
│ $ aipm task create                                                     │
│                                                                            │
│ 任务定义：                                                             │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 标题：实现用户认证模块                                                │ │
│ │ 描述：JWT 认证、权限验证、刷新令牌                                   │ │
│ │ 验收标准：单元测试覆盖率 > 90%                                        │ │
│ │ 预算：500 AIPM                                                      │ │
│ │ 截止：7 天                                                          │ │
│ │ 所需技能：Python, JWT, Redis                                        │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ 发布到 P2P 网络：                                                      │
│ - 任务签名（发起者 DID）                                               │
│ - 广播到 libp2p 网络                                                   │
│ - 存入任务注册表                                                       │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 2：AI 节点竞标任务                                                 │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 节点发现任务：                                                          │
│                                                                            │
│ 节点 A (Claude)：                                                      │
│ - 监听任务频道                                                         │
│ - 匹配任务要求（技能、负载）                                           │
│ - 计算竞标概率：92%                                                    │
│ - 提交竞标：450 AIPM                                                   │
│                                                                            │
│ 节点 B (DeepSeek)：                                                    │
│ - 匹配任务要求                                                         │
│ - 竞标价格：420 AIPM                                                   │
│                                                                            │
│ 节点 C (GPT-4)：                                                      │
│ - 负载过高，拒绝竞标                                                   │
│                                                                            │
│ 任务分配：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 竞标结果                                                             │ │
│ │ 中标：节点 A (Claude)                                               │ │
│ │ 价格：450 AIPM                                                      │ │
│ │ 成功率：92%                                                        │ │
│ │ 预计时间：2 天                                                      │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ 智能合约：                                                              │
│ - 锁定预算到托管                                                       │
│ - 记录任务分配                                                         │
│ - 设置里程碑                                                           │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 3：分布式执行与 同步                                               │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 任务执行：                                                              │
│                                                                            │
│ 节点 A (Claude) 执行：                                                 │
│ - 拉取任务代码                                                         │
│ - 实现认证模块                                                         │
│ - 编写单元测试                                                         │
│ - 提交到 git                                                          │
│                                                                            │
│ 进度同步：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 执行日志（实时广播）                                                 │ │
│ │ [10:00] 任务开始                                                    │ │
│ │ [10:15] 完成 JWT 核心逻辑                                          │ │
│ │ [10:45] 完成权限验证                                                │ │
│ │ [11:30] 编写测试用例                                               │ │
│ │ [11:50] 测试通过 ✅                                                │ │
│ │ [12:00] 提交代码                                                   │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ P2P 同步：                                                              │
│ - Gossip 协议广播状态                                                  │
│ - 多个节点验证结果                                                     │
│ - IPFS 存储交付物                                                      │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 4：验收与结算                                                     │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 自动验收：                                                              │
│ - CI 流水线运行测试                                                    │
│ - 测试覆盖率：95% ✅                                                   │
│ - 安全扫描：通过 ✅                                                    │
│ - 性能基准：通过 ✅                                                   │
│                                                                            │
│ 争议处理（如有）：                                                     │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 争议类型                                                             │ │
│ │ 1. 质量问题 → 社区仲裁                                               │ │
│ │ 2. 延期 → 扣除保证金                                               │ │
│ │ 3. 欺诈 → 惩罚机制                                                 │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ 结算：                                                                  │
│ - 释放托管资金                                                         │
│ - 更新声誉分                                                           │
│ - 记录贡献证明                                                         │
│                                                                            │
│ 结算明细：                                                             │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 执行节点：Claude                                                    │ │
│ │ 获得奖励：450 AIPM                                                 │ │
│ │ 声誉提升：+5 分 (85 → 90)                                         │ │
│ │ 贡献记录：已上链                                                   │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## 场景三：跨平台互操作

### 场景描述
项目需要与 GitHub、Linear 等第三方平台进行数据同步和任务联动。

### 互操作流程

```
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 1：平台桥接配置                                                    │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 配置 GitHub 桥接：                                                      │
│                                                                            │
│ $ aipm bridge add github --token $GITHUB_TOKEN                          │
│                                                                            │
│ 配置 Linear 桥接：                                                      │
│                                                                            │
│ $ aipm bridge add linear --api-key $LINEAR_KEY                          │
│                                                                            │
│ 桥接状态：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 已连接平台                                                          │ │
│ │ ✅ GitHub (组织：openai-collab)                                      │ │
│ │ ✅ Linear (工作区：openai-collab)                                    │ │
│ │ ⏳ Notion (待配置)                                                  │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 2：数据同步配置                                                    │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 同步规则：                                                              │
│                                                                            │
│ GitHub 同步：                                                           │
│ - Issue ↔ 任务双向同步                                                 │
│ - PR ↔ 交付物关联                                                      │
│ - Commit ↔ 进度更新                                                    │
│                                                                            │
│ Linear 同步：                                                           │
│ - Issue ↔ 任务同步                                                     │
│ - Cycle ↔ 里程碑同步                                                   │
│ - Epic ↔ 项目同步                                                      │
│                                                                            │
│ 冲突解决策略：                                                          │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 策略                                                                 │ │
│ │ 1. 优先使用本地修改                                                 │ │
│ │ 2. 标记冲突，人工解决                                               │ │
│ │ 3. 时间戳覆盖（可配置）                                             │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 3：自动化工作流                                                   │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 触发器配置：                                                            │
│                                                                            │
│ GitHub PR 合并 → Linear 更新状态                                        │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 触发条件：PR 合并到 main                                            │ │
│ │ 执行动作：                                                           │ │
│ │ 1. 找到关联任务                                                    │ │
│ │ 2. 更新任务状态为 "待验收"                                          │ │
│ │ 3. 通知验收者                                                       │ │
│ │ 4. 记录 PR 链接                                                    │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ 代码审查通过 → 任务完成                                                  │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 触发条件：GitHub 通过审查                                           │ │
│ │ 执行动作：                                                           │ │
│ │ 1. 验证所有检查通过                                                 │ │
│ │ 2. 更新里程碑进度                                                   │ │
│ │ 3. 触发结算流程                                                     │ │
│ │ 4. 更新声誉分                                                       │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 4：统一视图展示                                                   │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 统一任务看板：                                                          │
│                                                                            │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 项目：OpenAI-Collab - 统一视图                                       │ │
│ ├────────────────────────────────────────────────────────────────────────┤ │
│ │                                                                         │ │
│ │ 来源标识：                                                           │ │
│ │ 🐙 GitHub Issue #42 - 后端 API 开发                                  │ │
│ │ 📊 Linear Task-123 - 用户认证模块                                    │ │
│ │ 🤖 AIPM Task-001 - 权限验证                                         │ │
│ │                                                                         │ │
│ │ 状态同步：                                                           │ │
│ │ GitHub: open → closed ✅                                             │ │
│ │ Linear: In Progress → Done ✅                                        │ │
│ │ AIPM: In Review → Completed ✅                                       │ │
│ │                                                                         │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## 场景四：社区资金管理

### 场景描述
项目社区通过去中心化的方式进行资金管理和分配。

### 资金管理流程

```
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 1：资金池配置                                                      │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 资金来源：                                                              │
│ - 捐赠：50,000 AIPM                                                     │
│ - 协议税收：20%                                                        │
│ - 生态基金：100,000 AIPM                                               │
│                                                                            │
│ 分配规则：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 类别         │ 比例 │ 用途                                           │ │
│ ├────────────────────────────────────────────────────────────────────────┤ │
│ │ 开发基金    │ 40% │ 代码开发、代码审查                              │ │
│ │ 社区基金    │ 30% │ 文档撰写、社区支持                              │ │
│ │ 生态基金    │ 20% │ 集成开发、插件开发                              │ │
│ │ 储备基金    │ 10% │ 应急、长期发展                                  │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 2：资金使用提案                                                    │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 发起 Grant 提案：                                                       │
│                                                                            │
│ 提案内容：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 标题：前端 UI 现代化                                                 │ │
│ │ 作者：Bob                                                          │ │
│ │ 金额：10,000 AIPM                                                  │ │
│ │ 周期：2 个月                                                       │ │
│ │ 内容：                                                              │ │
│ │ - 重构 UI 组件库                                                    │ │
│ │ - 响应式设计适配                                                   │ │
│ │ - 深色模式支持                                                     │ │
│ │ - 单元测试覆盖                                                     │ │
│ │ - 文档撰写                                                         │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ 社区讨论：                                                              │
│ - 论坛帖子                                                             │
│ - 意见收集                                                             │
│ - 修订完善                                                             │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 3：链上投票                                                       │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 投票参数：                                                              │
│ - 投票期：7 天                                                        │
│ - 法定人数：5% 流通量                                                 │
│ - 通过门槛：60% 赞成                                                   │
│ - 最小投票额：1,000 AIPM                                               │
│                                                                            │
│ 投票统计：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 投票结果                                                             │ │
│ │ 参与率：8.5%（超过阈值）                                            │ │
│ │ 赞成：72%                                                          │ │
│ │ 反对：28%                                                          │ │
│ │ 结果：通过 ✅                                                       │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ 投票详情：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 地址               │ 投票   │ 权重                              │ │
│ ├───────────────────┼────────┼─────────────────────────────────────┤ │
│ │ did:eth:alice    │ 赞成   │ 50,000 AIPM                       │ │
│ │ did:eth:bob      │ 赞成   │ 20,000 AIPM                       │ │
│ │ did:eth:charlie  │ 反对   │ 15,000 AIPM                       │ │
│ │ ...              │ ...    │ ...                               │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 4：资金释放与 使用跟踪                                              │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 资金释放：                                                              │
│ - 托管合约释放资金                                                     │
│ - 受益人收到 10,000 AIPM                                               │
│ - 链上记录交易                                                         │
│                                                                            │
│ 分期释放：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 里程碑              │ 金额    │ 条件                              │ │
│ ├────────────────────┼────────┼───────────────────────────────────┤ │
│ │ 项目启动           │ 2,000  │ 签署合同                          │ │
│ │ 第一个月里程碑     │ 3,000  │ UI 组件完成 50%                  │ │
│ │ 第二个月里程碑     │ 3,000  │ 全部完成、测试通过                │ │
│ │ 最终验收           │ 2,000  │ 文档完成、代码审查通过            │ │
│ └────────────────────┴────────┴───────────────────────────────────┘ │
│                                                                            │
│ 使用跟踪：                                                              │
│ - 链上交易透明可查                                                     │
│ - 社区可监督资金使用                                                   │
│ - 定期报告要求                                                         │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## 场景五：分布式身份与声誉

### 场景描述
用户通过去中心化身份参与项目，声誉在整个生态中流通。

### 身份与声誉流程

```
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 1：创建去中心化身份                                                 │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 生成 DID：                                                              │
│                                                                            │
│ $ aipm identity create                                                  │
│                                                                            │
│ 生成结果：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ DID：did:aipm:alice:abc123xyz                                        │ │
│ │ 公钥：0xabc...123                                                    │ │
│ │ 私钥：（本地加密存储）                                               │ │
│ │ 文档：IPFS://QmXxx...                                               │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ 验证身份：                                                              │
│ - GitHub 验证                                                          │
│ - 邮箱验证                                                             │
│ - 社交验证                                                             │
│                                                                            │
│ 能力声明：                                                              │
│ - 技能标签：Python, React, AI/ML                                       │
│ - 经验年限：5 年                                                      │
│ - 过往项目：10+                                                       │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 2：声誉积累                                                        │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 贡献记录：                                                              │
│                                                                            │
│ 任务完成：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 任务：实现 JWT 认证                                                  │ │
│ │ 质量分：95/100                                                      │ │
│ │ 及时性：按时完成                                                    │ │
│ │ 沟通分：90/100                                                      │ │
│ │ 声誉提升：+8 分                                                    │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ 代码贡献：                                                              │
│ - PR 合并：10 次                                                      │
│ - 代码审查：5 次                                                      │
│ - Bug 修复：3 次                                                      │
│ - 声誉提升：+5 分                                                    │
│                                                                            │
│ 社区贡献：                                                              │
│ - 文档撰写：2 篇                                                      │
│ - 问题回答：20 次                                                     │
│ - 会议主持：3 次                                                      │
│ - 声誉提升：+5 分                                                    │
│                                                                            │
│ 声誉变化：                                                             │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 月份    │ 基础分  │ 任务  │ 代码  │ 社区  │ 总分   │ 等级   │ │
│ ├────────┼────────┼───────┼───────┼───────┼───────┼────────┤ │
│ │ Jan    │ 100    │ +5    │ +3    │ +2    │ 110    │ 探索者 │ │
│ │ Feb    │ 110    │ +8    │ +5    │ +5    │ 128    │ 贡献者 │ │
│ │ Mar    │ 128    │ +10   │ +7    │ +3    │ 148    │ 活跃   │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ 声誉等级：                                                              │
│ 探索者 → 贡献者 → 活跃 → 专家 → 导师 → 守护者                           │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 3：声誉跨项目使用                                                  │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 新项目加入：                                                            │
│                                                                            │
│ Alice 加入新项目：                                                      │
│ - 导入声誉：DID 验证                                                   │
│ - 声誉加分：项目特定权重                                               │
│ - 自动获得信任：基于历史声誉                                           │
│                                                                            │
│ 项目 A 的声誉：                                                         │
│ - 总分：148                                                           │
│ - 等级：活跃                                                           │
│ - 推荐任务：中高难度                                                   │
│                                                                            │
│ 项目 B 的声誉：                                                         │
│ - 总分：148                                                           │
│ - 加权：1.2x（项目 B 重视代码质量）                                   │
│ - 推荐任务：高难度核心模块                                             │
│                                                                            │
│ 声誉证明：                                                              │
│ - ZK 证明：可验证声誉但不暴露详情                                       │
│ - 选择性披露：只展示相关技能                                           │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## 场景六：争议解决机制

### 场景描述
当任务执行出现争议时，通过社区仲裁机制解决。

### 争议处理流程

```
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 1：发起争议                                                        │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 争议场景：                                                              │
│                                                                            │
│ 雇主主张：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 任务：实现用户认证模块                                               │ │
│ │ 问题：代码存在安全漏洞                                               │ │
│ │ 证据：安全扫描报告                                                  │ │
│ │ 要求：全额退款                                                      │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ 执行者回应：                                                            │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 反驳：漏洞在第三方库，非代码问题                                     │ │
│ │ 证据：依赖分析报告                                                 │ │
│ │ 建议：可免费修复                                                   │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ 争议登记：                                                              │
│ - 链上记录争议                                                         │
│ - 冻结托管资金                                                         │
│ - 分配仲裁者池                                                         │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 2：证据收集                                                        │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 双方提交证据：                                                          │
│                                                                            │
│ 雇主证据：                                                             │
│ 1. 安全扫描报告 - 发现 SQL 注入风险                                    │
│ 2. 问题代码截图                                                        │
│ 3. 验收标准文档                                                        │
│                                                                            │
│ 执行者证据：                                                            │
│ 1. 依赖分析报告 - 问题在第三方库                                       │
│ 2. 代码提交记录 - 已修复部分问题                                        │
│ 3. 第三方库安全公告                                                    │
│                                                                            │
│ 社区验证：                                                              │
│ - 独立安全审查                                                         │
│ - 自动化测试结果                                                       │
│ - 历史争议记录                                                         │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 3：社区仲裁                                                        │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 仲裁者池：                                                              │
│ - 随机选择 5 名仲裁者                                                  │
│ - 排除利益相关方                                                       │
│ - 确保声誉 > 80 分                                                    │
│                                                                            │
│ 仲裁流程：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 仲裁者职责                                                          │ │
│ │ 1. 审查所有证据                                                    │ │
│ │ 2. 独立给出裁决                                                    │ │
│ │ 3. 撰写裁决理由                                                    │ │
│ │ 4. 如分歧大，寻求更多证据                                          │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ 裁决结果：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 仲裁者 1：执行者 70%，雇主 30%                                      │ │
│ │ 仲裁者 2：执行者 50%，雇主 50%                                      │ │
│ │ 仲裁者 3：执行者 80%，雇主 20%                                      │ │
│ │ 仲裁者 4：执行者 60%，雇主 40%                                      │ │
│ │ 仲裁者 5：执行者 90%，雇主 10%                                      │ │
│ │                                                                      │ │
│ │ 平均：执行者 70%，雇主 30%                                          │ │
│ │ 最终裁决：执行者 获得 70% 费用                                      │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 4：执行与 改进                                                     │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 执行裁决：                                                              │
│ - 释放 70% 托管资金给执行者                                            │
│ - 退还 30% 给雇主                                                     │
│ - 记录争议结果                                                         │
│                                                                            │
│ 声誉影响：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 执行者                                                               │ │
│ │ - 声誉分：-5 分                                                    │ │
│ │ - 争议记录：+1                                                     │ │
│ │ - 需改进：安全审查能力                                              │ │
│ │                                                                    │ │
│ │ 雇主                                                                 │ │
│ │ - 声誉分：-2 分                                                    │ │
│ │ - 争议记录：+1                                                     │ │
│ │ - 需改进：需求描述能力                                              │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ 协议改进：                                                              │
│ - 审查争议案例                                                         │
│ - 更新验收标准模板                                                     │
│ - 添加安全检查清单                                                     │
│ - 完善协议条款                                                         │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## 场景七：开放生态集成

### 场景描述
第三方开发者通过开放 API 和 SDK 构建集成应用。

### 开发者生态流程

```
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 1：注册开发者应用                                                  │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 注册应用：                                                              │
│                                                                            │
│ $ aipm app register                                                    │
│                                                                            │
│ 应用配置：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 应用名称：AI 代码审查助手                                            │ │
│ │ 描述：自动审查 GitHub PR                                            │ │
│ │ 回调地址：https://ai-reviewer.example.com/callback                    │ │
│ │ 权限：                                                               │ │
│ │ - 读取任务                                                          │ │
│ │ - 写入审查结果                                                      │ │
│ │ - 访问声誉数据                                                      │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ API 密钥：                                                             │
│ - Key：pk_live_xxx                                                     │
│ - Secret：sk_live_yyy                                                  │
│ - 权限：production                                                     │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 2：开发集成                                                        │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ SDK 使用示例 (Python)：                                                │
│                                                                            │
│ ```python                                                              │
│ from aipm import SDK                                                   │
│                                                                            │
│ # 初始化                                                               │
│ sdk = SDK(key="pk_live_xxx", secret="sk_live_yyy")                    │
│                                                                            │
│ # 查询任务                                                             │
│ tasks = sdk.tasks.list(project_id="abc")                               │
│                                                                            │
│ # 提交审查结果                                                         │
│ result = sdk.reviews.create(                                           │
│     task_id="task-123",                                                │
│     findings=[...],                                                    │
│     score=85                                                          │
│ )                                                                      │
│                                                                            │
│ # 订阅事件                                                             │
│ for event in sdk.events.subscribe("task.completed"):                    │
│     print(f"任务完成: {event.task_id}")                               │
│ ```                                                                    │
│                                                                            │
│ OpenAPI 规范：                                                         │
│ - 完整 API 文档：docs.api.aipm.io                                     │
│ - Swagger UI：api.aipm.io/docs                                         │
│ - Postman 集合：docs/api/postman.json                                 │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 3：市场发布                                                        │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 提交到应用市场：                                                        │
│                                                                            │
│ $ aipm marketplace submit                                              │
│                                                                            │
│ 市场审核：                                                              │
│ - 安全扫描                                                              │
│ - 权限验证                                                              │
│ - 文档检查                                                              │
│ - 社区评审                                                              │
│                                                                            │
│ 上架信息：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 应用：AI 代码审查助手                                                │ │
│ │ 类别：开发工具                                                       │ │
│ │ 定价：免费（基础）/ $9/月（高级）                                  │ │
│ │ 评分：4.8/5 (120 评价)                                              │ │
│ │ 下载：1,200                                                          │ │
│ │ 开发者：CodeWizard Inc.                                             │ │
│ │ 验证：✅ 已审核                                                     │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│ 步骤 4：收益结算                                                        │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│ 收入统计：                                                              │
│ ┌────────────────────────────────────────────────────────────────────────┐ │
│ │ 订阅收入                                                             │ │
│ │ 月份    │ 免费用户 │ 付费用户 │ 收入                           │ │
│ │ Jan    │ 800      │ 50       │ $450                          │ │
│ │ Feb    │ 1,200    │ 120      │ $1,080                        │ │
│ │ Mar    │ 1,500    │ 200      │ $1,800                        │ │
│ └────────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│ 结算流程：                                                              │
│ - 每月 1 日结算                                                        │
│ - 扣除平台费（20%）                                                    │
│ - 自动转账到钱包                                                        │
│ - 链上交易记录                                                         │
│                                                                            │
│ 开发者收益：                                                            │
│ - 本月收入：$1,800                                                    │
│ - 平台费：-$360 (20%)                                                 │
│ - 税费：-$144 (8%)                                                    │
│ - 实际到账：$1,296                                                    │
│ - 到账时间：T+3                                                       │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

**文档版本**: v0.3
**更新日期**: 2026-02-17
**设计原则**: 开源、分布式、社区驱动
