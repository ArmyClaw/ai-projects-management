# AI Project Management Platform - 需求规格说明书 v0.5

> **版本说明**：基于v0.4，加入OpenClaw Skill设计，简化参与者AI使用

---

## 一、核心定位

### 1.1 产品愿景

> "让 AI 算力和专业能力像水电一样，按需取用，按贡献分配"

### 1.2 核心模式

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           项目协作核心模式                                  │
│                                                                             │
│      项目发起人                                                            │
│          │                                                                │
│          ▼                                                                │
│      发布项目 ── 拆解环节 ── 参与者认领 ── Skill调用AI ── 按贡献分成 │
│                                    ↑                                      │
│                               OpenClaw Skill                               │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 1.3 两种使用方式

| 维度 | 社区模式 | 企业模式 |
|------|---------|---------|
| **发起** | 任何人可发起 | 内部成员可发起 |
| **参与** | 开放参与 | 内部成员参与 |
| **可见性** | 公开项目 | 私有项目 |
| **AI使用** | Skill调用云端API | Skill调用云端API |
| **收益** | 现金分成 | 积分统计 |

---

## 二、OpenClaw Skill 设计

### 2.1 Skill 定位

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          Skill 在系统中的位置                              │
│                                                                             │
│  参与者                                                                  │
│     │                                                                     │
│     ▼                                                                     │
│  OpenClaw Skill ── 配置API Key ── 调用云端AI                           │
│     │                        │                                            │
│     │                        ▼                                            │
│     │               Claude / GPT-4 / DeepSeek / Qwen                     │
│     │                                                                     │
│     ▼                                                                     │
│  完成任务 ── 提交贡献 ── 获得分成                                        │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2.2 Skill 功能

**Skill名称**：AI Project Worker

**核心功能**：
| 功能 | 说明 |
|------|------|
| **API配置** | 配置云端AI的API Key |
| **模型选择** | 选择使用哪个AI模型 |
| **任务执行** | 根据任务描述调用AI完成 |
| **代码生成** | 生成代码、调试、重构 |
| **文档生成** | 生成技术文档、README |
| **代码审查** | 审查代码质量、安全 |
| **对话交互** | 支持多轮对话优化结果 |

### 2.3 Skill 配置

```yaml
# Skill 配置
config:
  # API供应商
  provider: 
    type: enum
    values: [anthropic, openai, deepseek, qwen, custom]
    default: anthropic
  
  # API配置
  api_key: 
    type: string
    description: API Key（加密存储）
  
  # 模型选择
  model:
    type: enum
    values: 
      anthropic: [claude-sonnet-4, claude-sonnet-4-20250514]
      openai: [gpt-4o, gpt-4o-mini]
      deepseek: [deepseek-chat]
      qwen: [qwen-turbo, qwen-plus]
    default: claude-sonnet-4
  
  # 使用限制
  limits:
    max_tokens: 100000      # 每月最大tokens
    max_cost: 1000         # 每月最大花费(元)
    budget_alert: 800       # 预算提醒阈值
  
  # 高级配置
  advanced:
    temperature: 0.7        # 生成温度
    system_prompt: ""      # 自定义系统提示词
    timeout: 60            # 超时时间(秒)
```

### 2.4 Skill 使用流程

```
参与者配置Skill
     │
     ▼
选择AI模型 + 配置API Key
     │
     ▼
认领任务
     │
     ▼
调用Skill执行任务
     │
     ├── 代码生成
     ├── 代码审查
     ├── 文档生成
     └── 对话优化
     │
     ▼
提交成果
     │
     ▼
贡献度计算
```

---

## 三、核心功能模块

### 3.1 模块总览

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      AI 项目协作平台                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐              │
│  │   项目中心   │  │   环节市场   │  │   Skill配置 │              │
│  │   发布/管理  │  │   浏览/认领  │  │   API配置   │              │
│  └──────────────┘  └──────────────┘  └──────────────┘              │
│         │                 │                 │                           │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐              │
│  │   参与者    │  │   贡献度    │  │   资金/积分  │              │
│  │   专长/档案  │  │   跟踪记录  │  │   分成结算   │              │
│  └──────────────┘  └──────────────┘  └──────────────┘              │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 MVP核心功能

| 模块 | 功能 | 说明 |
|------|------|------|
| **项目中心** | 发布项目 | 发起人发布项目，拆解环节 |
| | 管理项目 | 查看进度，管理参与者 |
| | 项目列表 | 浏览公开项目 |
| **环节市场** | 浏览环节 | 查看待认领的任务 |
| | 认领环节 | 参与者认领任务 |
| | 放弃环节 | 释放任务 |
| **Skill配置** | API配置 | 配置云端AI的API Key |
| | 模型选择 | 选择使用哪个AI模型 |
| | 成本监控 | 跟踪API使用量和花费 |
| **参与者** | 专长标签 | 自定义擅长领域 |
| | 个人档案 | 查看历史贡献 |
| | 系统评分 | 完成率/评分/响应 |
| **贡献度** | 贡献记录 | 跟踪每个贡献 |
| | 贡献证明 | 代码提交/文档/成果 |
| | 分成计算 | 按贡献比例分配 |
| **资金/积分** | 社区：现金 | 支付宝结算 |
| | 企业：积分 | 积分统计 |
| **项目加密** | 环节加密 | 选择哪些环节加密 |
| | 资料加密 | 加密项目资料和交付件 |
| | 密钥管理 | 发起人分发子密钥 |
| **参与者状态** | 在线管理 | 主动标记在线/离线 |
| | 活跃追踪 | 最近活跃时间显示 |
| | 任务状态 | 当前任务数量展示 |
| **备份机制** | 放弃任务 | 重新开放环节认领 |
| | 指定备用 | 发起人指定备用参与者 |
| | 任务接管 | 备用参与者接管任务 |

---

## 四、项目发布与管理

### 4.1 发布项目

**项目表单**：
```yaml
项目:
  title: 项目名称              # 必填
  description: 项目描述         # 必填
  visibility: [公开/私有]      # 社区=公开，企业=私有
  mode: [社区/企业]           # 选择模式
  total_budget: 10000         # 社区模式必填（预算）

  # 加密设置
  encryption:
    enabled: true/false        # 是否开启加密
    milestones: [1, 2]       # 需要加密的环节索引列表
    materials:               # 需要加密的资料类型
      - project_desc         # 项目描述
      - milestone_details     # 环节详情
      - code_repository      # 代码仓库
      - deliverables        # 交付件
      - chat_records         # 沟通记录

  # 环节拆解
  milestones:
    - name: 环节1名称
      description: 环节描述
      budget: 3000            # 环节预算
      skills: [Python, React]  # 需要的专长
      evidence: [代码, 文档]   # 需要提交的成果
      encrypted: true/false    # 是否加密

    - name: 环节2名称
      # ...
```

### 4.2 贡献度跟踪

```
参与者使用Skill执行任务
         │
         ▼
    调用云端AI（API Key由参与者提供）
         │
         ▼
    生成代码/文档/成果
         │
         ▼
    提交贡献
         │
         ▼
    贡献度计算

贡献类型：
├─ 代码贡献
│  ├─ Git提交记录
│  ├─ PR/Merge记录
│  └─ 代码审查记录
│
├─ 文档贡献
│  ├─ 文档编写
│  └─ 文档维护
│
└─ 其他贡献
   ├─ 测试记录
   ├─ 问题修复
   └─ 技术支持
```

---

## 五、Skill与成本

### 5.1 成本承担

| 角色 | 成本 | 说明 |
|------|------|------|
| **参与者** | API调用费用 | 参与者自己承担API费用 |
| **发起人** | 项目预算 | 发起人支付项目预算 |
| **平台** | 0 | 平台不收取AI费用 |

### 5.2 成本计算示例

```
参与者使用Claude API：

API调用成本：
├─ Claude Sonnet 4: ¥0.003/1K tokens
├─ 本次任务消耗：50K tokens
└─ 本次成本：¥0.15

参与者预估成本：
├─ 任务A：¥0.15
├─ 任务B：¥0.20
└─ 本日成本：¥0.35
```

### 5.3 Skill成本监控

```
参与者成本看板：
┌─────────────────────────────────────────────────────────────────────┐
│ 成本统计                                                               │
├─────────────────────────────────────────────────────────────────────┤
│                                                                    │
│ 本月使用：                                                              │
│ ├─ Anthropic (Claude): ¥45.23 / ¥500 限制                     │
│ ├─ OpenAI (GPT-4): ¥23.50 / ¥300 限制                       │
│ ├─ DeepSeek: ¥12.00 / ¥200 限制                             │
│ └─ 合计：¥80.73 / ¥1000 限制                               │
│                                                                    │
│ 预算提醒：                                                              │
│ ├─ Claude接近限制(90%) ⚠️                                  │
│ └─ 建议：升级配额或切换模型                                   │
│                                                                    │
│ [查看详情]  [配置API]  [升级配额]                              │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 五、参与者在线状态管理

### 5.1 在线状态定义

**参与者状态**：
| 状态 | 标识 | 触发条件 | 可见范围 |
|------|------|----------|-----------|
| **🟢 在线** | 用户主动标记 | 参与者点击"在线"按钮 | 发起人可见 |
| **🟡 忙碌** | 正在执行任务 | 开始执行任务时自动切换 | 发起人可见 |
| **🔴 离线** | 主动标记/自动 | 用户主动点击或超时24h自动 | - |

**状态切换规则**：
```
参与者状态流转：
    ┌─────────────────────────────────────────────────────┐
    │                                                     │
    │  离线 ──→ 在线 ──→ 忙碌 ──→ 离线                   │
    │     │         │          │        │                  │
    │     │         │          │        │                  │
    │     └─────────┴──────────┴────────┘                  │
    │              ↑            ↓                            │
    │              │         完成任务                        │
    │              │                                          │
    │              └───── 超时24h自动                       │
    │                                                     │
    └─────────────────────────────────────────────────────┘
```

### 5.2 在线状态显示

**参与者列表展示**：
```
发起人查看参与者状态：
┌─────────────────────────────────────────────────────────────────────┐
│ 参与者列表                                                        │
├─────────────────────────────────────────────────────────────────────┤
│                                                                   │
│ 🟢 李四          最近活跃：刚刚          当前任务：1个           │
│    专长：Python, FastAPI              评分：4.7/5.0            │
│                                                                   │
│ 🟡 王五          最近活跃：10分钟前      当前任务：2个           │
│    专长：React, TypeScript            评分：4.8/5.0            │
│                                                                   │
│ 🔴 赵六          最近活跃：2小时前       当前任务：0个           │
│    专长：Node.js, Docker             评分：4.5/5.0            │
│                                                                   │
│ 🔴 周七          最近活跃：1天前        当前任务：0个           │
│    专长：Go, Kubernetes              评分：4.6/5.0            │
│                                                                   │
└─────────────────────────────────────────────────────────────────────┘
```

### 5.3 活跃追踪

**活跃时间记录**：
| 触发动作 | 记录时间 | 影响 |
|----------|----------|------|
| 登录平台 | 当前时间 | 更新最近活跃 |
| 使用Skill | 当前时间 | 更新最近活跃 |
| 提交贡献 | 当前时间 | 更新最近活跃 |
| 标记离线 | 用户操作 | 状态切换 |
| 无操作24h | 系统自动 | 标记离线 |

---

## 六、备份机制

### 6.1 备份场景

**备份触发场景**：
| 场景 | 处理方式 | 发起人操作 |
|------|----------|-----------|
| 参与者放弃任务 | 环节重新开放认领 | 无需操作 |
| 参与者失联(超时24h) | 环节重新开放认领 | 发起人可指定备用 |
| 发起人主动替换 | 指定备用参与者接管 | 手动选择 |

### 6.2 备用参与者机制

**指定备用**：
```yaml
备用参与者配置:
  # 项目级别备用（可选）
  backup_participants:
    - user_id: user_002
      name: 王五
      skills: [React, TypeScript]
      state: online  # 在线状态
    - user_id: user_003
      name: 赵六
      skills: [Node.js, Docker]
      state: busy    # 忙碌状态

  # 环节级别备用（可选）
  milestones:
    - name: 环节1
      backup_participants: [user_002, user_003]
```

**备用接管流程**：
```
参与者失联
     │
     ▼
发起人收到通知
     │
     ├── 放弃任务 → 重新开放认领
     │
     ▼
选择备用参与者
     │
     ▼
备用确认接管
     │
     ▼
任务转移
     │
     ▼
备用继续执行
```

### 6.3 任务放弃流程

**参与者放弃任务**：
```
步骤1：参与者申请放弃
步骤2：发起人确认
步骤3：环节重新开放认领
步骤4：新参与者认领
```

**放弃处理**：
| 放弃原因 | 影响 | 处理 |
|----------|------|------|
| 任务超出能力 | 信誉分-1 | 重新开放认领 |
| 个人原因 | 无惩罚 | 重新开放认领 |
| 恶意放弃 | 信誉分-3 | 限制接单7天 |

---

## 六、项目加密功能

### 6.1 加密设置

**加密粒度**：
| 类型 | 说明 |
|------|------|
| **环节加密** | 每个环节独立加密 |
| **资料加密** | 项目资料和交付件加密 |

**可加密内容**：
| 内容 | 说明 |
|------|------|
| 项目描述 | 项目基本信息 |
| 环节详情 | 每个环节的详细描述 |
| 代码仓库 | Git代码仓库 |
| 交付件 | 完成的代码/文档/成果 |
| 沟通记录 | 任务沟通记录 |

### 6.2 密钥管理

**密钥类型**：
| 类型 | 拥有者 | 权限 |
|------|--------|------|
| **总密钥** | 发起人 | 管理所有子密钥，解密所有内容 |
| **子密钥** | 参与者 | 仅解密自己参与的环节 |

**密钥分发流程**：
```
参与者申请认领
       │
       ▼
   发起人确认
       │
       ├── 拒绝 → 不分配密钥
       │
       ▼
   生成子密钥（AES-256）
       │
       ▼
   安全分发（加密传输）
       │
       ▼
   参与者接收并存储
```

### 6.3 加密流程

**加密算法**：AES-256-GCM（对称加密）

**加密流程**：
```python
# 发起人加密
master_key = generate_aes256_key()  # 生成主密钥

# 环节加密
for milestone in encrypted_milestones:
    encrypted_content = aes256_encrypt(
        content=milestone.description,
        key=master_key
    )
    store_encrypted(encrypted_content)

# 子密钥生成
participant_key = aes256_encrypt(
    content=master_key,
    key=participant_public_key  # 用参与者公钥加密
)

# 参与者解密
master_key = aes256_decrypt(
    encrypted_key=participant_key,
    key=participant_private_key  # 用私钥解密
)

content = aes256_decrypt(
    encrypted_content=encrypted_content,
    key=master_key
)
```

### 6.4 密钥撤销

**撤销场景**：
| 场景 | 处理方式 |
|------|----------|
| 参与者放弃环节 | 自动撤销子密钥 |
| 项目结束 | 自动删除所有密钥 |
| 密钥泄露 | 发起人可重新生成主密钥 |
| 争议处理 | 平台可协助解密（仲裁需要） |

---

## 七、参与者与专长

### 7.1 专长标签

**用户自定义标签**：
```yaml
标签类型:
├─ 技术栈:
│  ├─ 前端: React / Vue / Angular
│  ├─ 后端: Python / Go / Node.js
│  ├─ AI/ML: TensorFlow / PyTorch
│  └─ 数据库: MySQL / PostgreSQL / MongoDB
│
├─ 专业领域:
│  ├─ 架构设计
│  ├─ 性能优化
│  ├─ 安全加固
│  └─ 技术文档
│
└─ 工具/平台:
   ├─ Claude / GPT-4
   ├─ Cursor / GitHub Copilot
   └─ Docker / K8s
```

### 7.2 系统评分

```
评分维度:
├─ 完成率 = 完成任务数 / 承接任务数
├─ 质量分 = 平均验收评分 (5分制)
├─ 响应分 = 平均响应时间评分
└─ 协作分 = 同行/发起人评价

系统评分 = 完成率(40%) + 质量分(35%) + 响应分(15%) + 协作分(10%)
```

### 7.3 个人档案

```
档案展示:
├─ 专长标签（自己定义）
├─ 系统评分（完成率/质量/响应/协作）
├─ 历史项目
│  ├─ 参与项目数
│  ├─ 贡献度排名
│  └─ 获得分成
├─ Skill配置
│  ├─ 已配置API：Claude, GPT-4
│  ├─ 本月成本：¥80.73
│  └─ 配额状态：正常
└─ 联系方式（可选）
```

---

## 八、分成结算

### 8.1 分成规则

**按实际贡献分配**：
```
项目总预算 = ¥10,000

环节1：¥3,000
├─ 参与者A：贡献度60% → ¥1,800
└─ 参与者B：贡献度40% → ¥1,200

环节2：¥5,000
├─ 参与者C：贡献度50% → ¥2,500
└─ 参与者D：贡献度50% → ¥2,500

环节3：¥2,000
├─ 发起人：贡献度30% → ¥600
├─ 参与者E：贡献度40% → ¥800
└─ 参与者F：贡献度30% → ¥600
```

### 8.2 结算流程

```
项目完成 → 发起人验收 → 生成贡献报告 → 确认分成比例 → 资金/积分分配
                                    │
                                    ▼
                              ┌─────────────┐
                              │ 争议处理   │
                              │ 7天内申诉  │
                              └─────────────┘
```

### 8.3 两种模式结算

| 维度 | 社区模式 | 企业模式 |
|------|---------|---------|
| **资金来源** | 发起人预付 | 企业预算 |
| **分成形式** | 现金 | 积分 |
| **结算时间** | 验收后T+1 | 月度统计 |
| **提现** | 支付宝/微信 | 积分商城 |
| **AI成本** | 参与者自付 | 参与者自付 |

---

## 九、技术架构（MVP）

### 9.1 技术选型

| 层级 | 技术 | 说明 |
|------|------|------|
| **Skill** | OpenClaw Skill | 调用云端AI |
| **前端** | React + Ant Design | 组件丰富 |
| **后端** | Node.js + Express | 轻量熟悉 |
| **数据库** | PostgreSQL | 关系数据 |
| **缓存** | Redis | Session/缓存 |
| **部署** | Docker + 1台云服务器 | 简单成本低 |

### 9.2 数据模型

```
核心表:
├─ users                    # 用户表
├─ projects                 # 项目表
├─ project_milestones       # 项目环节表
├─ milestone_contributions   # 贡献记录表
├─ contributions            # 贡献明细表
├─ settlements              # 结算表
├─ user_skills              # 用户专长表
├─ skill_configs            # Skill配置表
└─ encryption_keys           # 加密密钥表
```

### 9.3 开发周期

| 阶段 | 时间 | 内容 |
|------|------|------|
| 设计 | 1周 | 详细设计、接口定义 |
| Skill开发 | 1周 | OpenClaw Skill实现 |
| 前端 | 3周 | React开发 |
| 后端 | 3周 | API + 数据库 |
| 测试 | 1周 | 功能测试 |
| 部署 | 1周 | 上线 |
| **合计** | **10周** | 2.5个月 |

---

## 十、商业模式

### 10.1 收入来源（社区模式）

| 模式 | 比例 | 说明 |
|------|------|------|
| **交易抽佣** | 8-15% | 项目预算抽佣 |

### 10.2 抽佣比例

| 预算范围 | 抽佣比例 |
|---------|----------|
| < ¥5,000 | 15% |
| ¥5,000-20,000 | 12% |
| ¥20,000-100,000 | 10% |
| > ¥100,000 | 8% |

### 10.3 成本结构

| 项目 | 月成本 |
|------|--------|
| 云服务器 | ¥500-1000 |
| 数据库 | ¥300 |
| 运维 | ¥2000 |
| **合计** | ¥3000-3500 |

### 10.4 盈亏平衡

- 月交易额 ¥30,000 → 覆盖成本
- 月交易额 ¥100,000 → 开始盈利

---

## 十一、MVP功能清单

### 11.1 P0必须功能

| 模块 | 功能 | 说明 |
|------|------|------|
| **项目中心** | 发布项目 | 表单+环节拆解 |
| | 管理项目 | 进度查看 |
| | 项目列表 | 公开项目浏览 |
| **环节市场** | 浏览环节 | 按技能筛选 |
| | 认领环节 | 申请参与 |
| **Skill配置** | API配置 | 配置云端AI |
| | 模型选择 | 选择使用模型 |
| | 成本监控 | 跟踪API花费 |
| **参与者** | 专长标签 | 自定义 |
| | 个人档案 | 历史记录 |
| | 系统评分 | 完成率/评分 |
| **贡献度** | 贡献记录 | 跟踪贡献 |
| | 分成计算 | 按贡献分配 |
| **结算** | 社区现金 | 支付宝结算 |
| | 企业积分 | 积分统计 |
| **加密** | 环节加密 | 选择加密 |
| | 资料加密 | 加密资料 |
| | 密钥管理 | 分发子密钥 |

### 11.2 P1延后功能

| 功能 | 原因 |
|------|------|
| 高级贡献分析 | 延后 |
| 企业管理员配置 | 延后 |
| 积分商城 | 延后 |

---

## 十二、成功指标

### 12.1 核心指标

| 指标 | MVP目标 |
|------|---------|
| 月活跃发起人 | 20人 |
| 月活跃参与者 | 50人 |
| 月项目数 | 30个 |
| 月交易额 | ¥50,000 |
| 贡献完成率 | 75% |
| 好评率 | 4.0/5.0 |

### 12.2 验证假设

| 假设 | 验证方式 | 通过标准 |
|------|----------|----------|
| 有人愿意发起项目 | 项目发布数 | >30/月 |
| 有人愿意参与 | 认领数/项目 | >2人/项目 |
| Skill使用顺畅 | API调用成功率 | >95% |
| 愿意现金分成 | 社区项目占比 | >50% |

---

**文档版本**: v0.5
**更新日期**: 2026-02-17
**设计原则**: 加入OpenClaw Skill设计，简化参与者AI使用
